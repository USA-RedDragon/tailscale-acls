// This tailnet's ACLs are maintained in https://github.com/USA-RedDragon/tailscale-acls
{
	"tagOwners": {
		"tag:open": ["autogroup:admin"],
	},

	"acls": [
		// Admins can access admin tag
		{"action": "accept", "src": ["autogroup:admin"], "dst": ["*:*"]},
		// Can always access internet
		{"action": "accept", "src": ["autogroup:member"], "dst": ["autogroup:internet:*"]},
		// Can always access self
		{"action": "accept", "src": ["autogroup:member"], "dst": ["autogroup:self"]},
		// Can always access open
		{"action": "accept", "src": ["autogroup:member"], "dst": ["tag:open:*"]},
	],

	"ssh": [
		{
			"action": "accept",
			"src":    ["autogroup:member"],
			"dst":    ["autogroup:self"],
			"users":  ["autogroup:nonroot"],
		},
		{
			"action": "accept",
			"src":    ["autogroup:admin"],
			"dst":    ["*:*"],
			"users":  ["autogroup:nonroot", "root"],
		},
	],

	// Test access rules every time they're saved.
	"tests": [
	 	{
	 		"src": "USA-RedDragon@github",
	 		"accept": ["*"],
	 	},
		{
	 		"src": "torvalds@github",
	 		"accept": [],
	 		"deny": ["tag:open:*"],
	 	},
		{
			"src": "autogroup:member",
			"accept": ["tag:open:*"],
			"deny": ["autogroup:admin"],
		},
	],
}
